<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatos de Gatos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #fdfcfb 0%, #e2d1c3 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        .cat-animation {
            transition: transform 0.3s ease;
        }

        .cat-animation:hover {
            transform: translateY(-5px) rotate(3deg);
        }

        .loader {
            border-top-color: #f6ad55;
            animation: spinner 0.6s linear infinite;
        }

        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center p-4">

    <div class="w-full max-w-md glass-card rounded-3xl p-8 text-center">
        <!-- Ícone e Cabeçalho -->
        <div class="mb-6">
            <div class="bg-orange-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 cat-animation">
                <i class="fas fa-cat text-4xl text-orange-500"></i>
            </div>
            <h1 class="text-2xl font-bold text-gray-800">Fatos de Gatos</h1>
            <p class="text-gray-500 text-sm">Descubra curiosidades incríveis sobre felinos</p>
        </div>

        <!-- Área do Fato -->
        <div id="fact-container" class="min-h-[120px] flex items-center justify-center mb-8 px-2">
            <p id="fact-text" class="text-gray-700 text-lg leading-relaxed italic">
                Clique no botão abaixo para carregar um fato curioso!
            </p>
            
            <!-- Loader (Escondido por padrão) -->
            <div id="loader" class="hidden">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-10 w-10"></div>
            </div>
        </div>

        <!-- Botão de Ação -->
        <button id="get-fact-btn" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-4 px-6 rounded-2xl transition-all duration-300 transform active:scale-95 shadow-lg flex items-center justify-center gap-2">
            <span>Novo Fato</span>
            <i class="fas fa-paw"></i>
        </button>

        <!-- Mensagem de Erro (Escondida) -->
        <div id="error-box" class="hidden mt-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm">
            Ops! Não conseguimos buscar o fato. Tente novamente.
        </div>
    </div>

    <!-- Rodapé -->
    <footer class="mt-8 text-gray-500 text-xs text-center">
        <p>Dados fornecidos pela MeowFacts API</p>
        <p class="mt-1">© 2024 - Feito para amantes de gatos</p>
    </footer>

    <script>
        const factText = document.getElementById('fact-text');
        const factBtn = document.getElementById('get-fact-btn');
        const loader = document.getElementById('loader');
        const errorBox = document.getElementById('error-box');

        /**
         * Busca um fato aleatório da API MeowFacts em português
         */
        async function fetchCatFact() {
            // Reset de UI
            errorBox.classList.add('hidden');
            factText.classList.add('hidden');
            loader.classList.remove('hidden');
            factBtn.disabled = true;
            factBtn.classList.add('opacity-70');

            // Implementação de retry com backoff exponencial simples
            let attempts = 0;
            const maxAttempts = 3;
            let success = false;

            while (attempts < maxAttempts && !success) {
                try {
                    // API endpoint com parâmetro de idioma para Português
                    const response = await fetch('https://meowfacts.herokuapp.com/?lang=por');
                    
                    if (!response.ok) throw new Error('Falha na resposta da rede');
                    
                    const data = await response.json();
                    
                    // A API retorna { "data": ["Fato aqui"] }
                    if (data && data.data && data.data.length > 0) {
                        displayFact(data.data[0]);
                        success = true;
                    } else {
                        throw new Error('Formato de dados inválido');
                    }
                } catch (error) {
                    attempts++;
                    if (attempts >= maxAttempts) {
                        showError();
                    } else {
                        // Espera um pouco antes de tentar novamente (1s, 2s)
                        await new Promise(resolve => setTimeout(resolve, attempts * 1000));
                    }
                }
            }

            // Restaura UI
            loader.classList.add('hidden');
            factBtn.disabled = false;
            factBtn.classList.remove('opacity-70');
        }

        /**
         * Exibe o texto do fato com uma pequena animação de fade
         */
        function displayFact(text) {
            factText.textContent = `"${text}"`;
            factText.classList.remove('hidden');
            factText.style.opacity = 0;
            
            // Simples fade in manual via JS
            let op = 0;
            const timer = setInterval(() => {
                if (op >= 1) clearInterval(timer);
                factText.style.opacity = op;
                op += 0.1;
            }, 30);
        }

        /**
         * Mostra a caixa de erro customizada
         */
        function showError() {
            loader.classList.add('hidden');
            errorBox.classList.remove('hidden');
            factText.textContent = "Clique para tentar novamente.";
            factText.classList.remove('hidden');
        }

        // Event Listeners
        factBtn.addEventListener('click', fetchCatFact);

        // Carregar um fato inicial ao abrir a página
        window.addEventListener('load', fetchCatFact);
    </script>
</body>
</html>

